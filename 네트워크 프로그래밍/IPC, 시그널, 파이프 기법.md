# IPC 개념 그리고 시그널/ 파이프 기법

### IPC

- Inter Process Communication
- 프로세스간 통신

### 시그널

- 소프트웨어 인터럽트 (Software Interupt)를 위한 신호

---

---

## IPC 개념

### 프로세스간 통신 (Inter Process Communication)

- 프로세스간 데이터를 공유/ 전송할 수 있도록 운영체제에 의해 제공되는 서비스
- 프로세스는 원격의 호스트 컴퓨터나 서로 다른 운영체제에서 동작될 수 있으며, 이러한 환경에서도 프로세스간의 통신이 가능토록
  표준화된 인터페이스를 제공
- 원격의 컴퓨터 기반에서는 일반적으로 TCP/IP를 기반으로 한 클라이언트/서버 모델을 주로 사용
- 로컬호스트 내 IPC 대비, 네트워크 기반의 IPC는 통신 대역폭 (Bandwidth)과 지연 (Latency)에 따른 성능 영향성이 큼
- 로컬 호스트상
  - 파일 공유
  - 시그널
  - 파이프
  - FIFO
  - 공유 메모리
  - 메시지큐
- 네트워크 상

  - 소켓

- 동시 접근 문제 해결
- 동기/ 비동기
- 데이터 경계

---

## 시그널 (Signal)

### 시그널 이란?

- 프로세스에게 전달되는 소프트웨어 인터럽트 신호
- 소프트웨어 인터럽트를 수신한 프로세스는 신호의 종류에 따라 등록한 핸들러(handler)를 수행하거나, 무시 또는 운영체제 제어에 의한 프로세스 종료 등이 수행
- 관련 API
  - kill, signal, abort, alarm, raise, sigsend 등
- 시스템에서 제공되는 시그널들은 `kill -l` 명령을 통해서 확인 가능
- 각 시그널에 대한 자세한 설명은 `man 7 signal` 명령을 통해 확인
- 대표적인 시그널 종류 (숫자는 유닉스 종류에 따라 일부 차이가 있음)

| 이름        | 설명                                           |
| ----------- | ---------------------------------------------- |
| SIGHUP(1)   | 터미널 또는 링크 등이 종료될 때 발생하는 신호  |
| SIGINT(2)   | Ctrl + C 신호, 프로세스는 강제 종료용          |
| SIGQUIT(3)  | Ctrl + \ 신호, 프로세스 종료용                 |
| SIGABRT(6)  | abort 함수의 신호, 프로세스 비정상 종료 알림용 |
| SIGKILL(9)  | 프로세스 강제 종료용                           |
| SIGUSR1(10) | 사용자 정의 시그널 1                           |
| SIGUSR2(12) | 사용자 정의 시그널 2                           |
| SIGALRM(14) | 알람 시그널 발생용                             |
| SIGCONT(18) | 정지된 프로세스에 대한 재진행 (Continue)       |
| SIGSTOP(19) | 프로세스 정지 신호                             |
| SIGTSTP(20) | Ctrl + Z 신호, 프로세스 정지                   |

### 함수 kill()

- 지정한 프로세스에게 시그널을 전달
- 일반사용자는 목적지 프로세스의 접근 권한이 있어야 함

### 함수 signal()

- 수신한 시그널에 대하여 처리하기 위한 핸들러를 등록하는 함수
- 프로세스가 등록된 시그널을 수신하면, 해당 핸들러를 실행함

---

## 파이프 (PIPE와 FIFO)

### 파이프(PIPE)

- 데이터의 순서는 입력과 출력이 동일
- 2개의 크기를 갖는 배열형태의 파일 기술자 (File Descriptor)를 생성하여 운영
- 배열 0의 주소에는 수신용, 1의 주소에는 송신용으로 사용
- 운영체제가 부여해준 파일기술자를 활용하는 기법이기에 이를 공유하기 위한 자식 프로세스 생성 방식 (fork() 또는 thread())으로 사용
- 파일기술자는 한 개의 프로세스라도 잔존 시 존재하며, 큐의 내용물도 운영체제에 의해 보관됨
- 송수신 데이터의 기본 크기는 바이트 단위

- 함수 pipe()
  - 인자
    - 크기가 2인 파일 기술자 배열
  - 반환값
    - 성공하면 0, 실패하면 -1

### FIFO

- FIFO(First-In-First-Out)을 위한 특별한 파일을 생성
- 파일시스템에서 파일의 이름정보를 활용하고, 내용물(몸체)는 운영체제가 관리하는 시스템 메모리에 존재
- 파일시스템의 접근권한을 변경하여 타사용자의 프로세스와 통신도 가능
- mkfifo 명령을 통해서도 FIFO 파일을 생성할 수 있음
- open() 함수를 통해 접근할때, 반드시 두 프로세스에서 `O_RDONLY`와 `O_WRONLY`모드로 접근을 해야함

  - 그렇지 않으면 블록킹 상태로 진입

- 함수 mkfifo()
  - 인자
    - FIFO용 파일명, 파일접근모드
  - 반환값
    - 성공하면 0, 실패하면 -1
