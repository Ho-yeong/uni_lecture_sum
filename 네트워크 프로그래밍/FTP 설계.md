# FTP 설계

### RFC 959

- RFP(Request For Comments)의 959번에 등재된 인터넷 표준 권고사항으로 인터넷상에서 파일을 전송하기 위한 규정

---

---

## FTP 접속 및 인증

### FTP 개념

- File Transfer Protocol (파일 전송 프로토콜)
- RFC 959에 정의
  - 인터넷 기술 표준을 위한 간행물로 강제성은 없음
- TCP/IP를 기반으로 한 서버-클라이언트 접속(pair)간 파일을 공유하기 위한 통신규약

- 일반적으로 서버와 클라이언트는 독립적인 연결로 운영 <- Concurrent 방식
- 서버에 접속된 클라이언트들 간 직접적인 데이터 공유기능 없음

### FTP 프로그램 구조

- User Interface
  - 사용자 접근 편이를 위한 인터페이스
    - CUI, GUI
  - Protocol Interpreter (PI)
    - 제어 명령 처리 및 관련 제어정보 송수신
    - 통신 채널 생명주기: 연결 종료
  - Data Transfer Process (DTP)
    - 파일 및 데이터 전송 처리기
    - 통신 채널 생명주기: 데이터 전송 종료

### 접속 및 인증 절차

- PI 통신 채널 생성 (TCP/IP 소켓 접속)
- 사용자 계정정보 송수신을 통한 채널 유지 및 이후 기능 수행

### 연결 종료 및 기능 해제

- 연결 종료
  - 연결된 통신 채널을 따라 종료
    - 파일 전송중이면, 강제 중단 후 접속 종료
- 기능 해제
  - 직전 명령에 대한 처리 기능을 중단
    - 데이터 전송 중, 관련 기능 중단

### 파일 수신 (S -> C)

- PI 채널을 통해 파일을 요청하는 메시지를 전달
- 서버는 PI채널을 통해, 명령에 대한 상태 정보를 알려줌
- 실제적인 데이터 전송은 DTP(Data Transfer Process)용 별도의 채널로 이루어짐

### 파일 송신 (C -> S)

- PI 채널을 통해 파일 송신할 것이라는 요청 메시지를 전달
- 서버는 PI채널을 통해, 명령에 대한 상태 정보를 알려줌
- 실제적인 데이터 전송은 DTP(Data Transfer Process)용 별도의 채널로 이루어짐

### 파일시스템 제어

- 디렉토리 기능
  - 생성, 삭제, 이동
- 파일 기능
  - 삭제
- 항목 보기
  - 리스트 출력

### 전송 모드

- ACTIVE 와 PASSIVE 모드 제공

  - ACTIVE 모드
    - 전송채널(DTP)를 서버가 생성 (서버 -> 클라이언트 접속 요청)
  - PASSIVE 모드
    - 전송채널(DTP)를 클라이언트가 생성 (클라이언트 -> 서버 접속 요청)

- PI 채널을 통해 PASV 명령으로 PASSIVE 모드로 전환
- 기 변환된 PASSIVE 모드에서는 다시 ACTIVE 모드로 변경이 불가
- DTP 채널은 데이터 전송에 관련한 명령이 처리될 떄, 일시적으로 생성되어 활용

---

## FTP 명령

### FTP 프롬프트

- 작성할 FTP 클라이언트 프로그램은 CUI 제공
- ex
  - 계정: ftp
  - 프롬프트: [ftp]

### 접속 및 인증

- 명령 창에서
  - cmd [\<ip\> \<port\> [\<username\> \<p/w\>]] 형태로 입력

### 명령: 접속 해제 및 모드 변경

- 접속 해제: BYE
  - 파일이 전송중일 때, 전송 중지 후 접속을 종료
- 기능 종료: ABORT
  - 직전 기능에 대한 취소
- PASSIVE 모드로 변환
  - PASV, PASSIVE
- 프로그램 종료
  - EXIT
- ASCII 와 2진 모드 변환
  - ASCII
  - BIN, BINARY

### 서버 동작

- 두 개의 인자를 입력 받음
  - 기본포트 ,추가포트(ACTIVE 모드용)
- 접속된 클라이언트를 위한 서버 복제 방식의 운영
